<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>BonusCoin Minter</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@solana/wallet-adapter-react-ui@0.19.17/dist/index.css">
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:#f0f2f5; display:flex; justify-content:center; padding:30px; }
    #bonuscoinMinter {
      max-width: 450px; width:100%; padding:20px; background:#ffffff; border-radius:15px;
      box-shadow:0 8px 25px rgba(0,0,0,0.15);
    }
    h2 { text-align:center; color:#2c3e50; margin-bottom:20px; }
    input, textarea { width:100%; padding:10px; margin-bottom:12px; border-radius:10px; border:1px solid #ccc; font-size:14px; box-sizing:border-box; }
    button {
      width:100%; padding:12px; border:none; border-radius:10px; font-size:16px; cursor:pointer; margin-bottom:12px;
      transition:0.3s;
    }
    #connectWallet { background:#4caf50; color:#fff; }
    #connectWallet:hover { background:#45a049; }
    #mintButton { background:#2196f3; color:#fff; }
    #mintButton:hover { background:#1976d2; }
    #status { margin-top:10px; padding:10px; background:#e8f4fd; border-radius:10px; min-height:24px; color:#2c3e50; }
    #mintAddress { margin-top:10px; padding:10px; background:#e0ffe0; border-radius:10px; min-height:24px; color:#2c3e50; word-break:break-all; }
  </style>
</head>
<body>
  <div id="bonuscoinMinter">
    <h2>BonusCoin Token Minter</h2>
    <button id="connectWallet">Connect Wallet</button>
    <input type="text" id="tokenName" placeholder="Token Name" value="BonusCoin">
    <input type="text" id="tokenSymbol" placeholder="Token Symbol" value="BONUS">
    <textarea id="tokenDescription" placeholder="Description">Official BonusCoin token</textarea>
    <button id="mintButton">Mint BonusCoin</button>
    <div id="status"></div>
    <div id="mintAddress"></div>
  </div>

  <!-- Solana Web3.js and SPL Token CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@1.77.0/lib/index.iife.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@solana/spl-token@0.3.8/lib/index.iife.min.js"></script>

  <script>
    window.addEventListener('load', async () => {
      const statusEl = document.getElementById('status');
      const mintAddressEl = document.getElementById('mintAddress');
      const { Connection, clusterApiUrl } = solanaWeb3;
      const { createMint, getOrCreateAssociatedTokenAccount, mintTo, TOKEN_PROGRAM_ID } = splToken;

      const connection = new Connection(clusterApiUrl('mainnet-beta'), 'confirmed');
      let provider = null;

      // Connect any wallet (Phantom, Solflare, etc.)
      document.getElementById('connectWallet').onclick = async () => {
        try {
          if (window.solana && window.solana.isPhantom) {
            provider = window.solana;
          } else if (window.solflare && window.solflare.isSolflare) {
            provider = window.solflare;
          } else {
            alert("No supported wallet found. Install Phantom, Solflare, or compatible wallet.");
            return;
          }
          const resp = await provider.connect();
          statusEl.innerText = "Wallet connected: " + resp.publicKey.toString();
        } catch (err) {
          statusEl.innerText = "Connection failed: " + err.message;
        }
      };

      // Mint BonusCoin
      document.getElementById('mintButton').onclick = async () => {
        if (!provider || !provider.publicKey) { alert("Connect wallet first!"); return; }

        const walletPublicKey = provider.publicKey;
        const signTransaction = provider.signTransaction.bind(provider);

        const name = document.getElementById('tokenName').value;
        const symbol = document.getElementById('tokenSymbol').value;
        const decimals = 9;
        const totalSupply = 1000000000n;
        const totalUnits = totalSupply * 10n ** BigInt(decimals);

        statusEl.innerText = "Creating mint...";
        try {
          const mint = await createMint(
            connection,
            { publicKey: walletPublicKey, signTransaction },
            walletPublicKey,
            null,
            decimals,
            undefined,
            { commitment: 'confirmed' },
            TOKEN_PROGRAM_ID
          );

          const tokenAccount = await getOrCreateAssociatedTokenAccount(
            connection,
            { publicKey: walletPublicKey, signTransaction },
            mint,
            walletPublicKey
          );

          statusEl.innerText = `Minting ${totalSupply.toLocaleString()} tokens...`;
          await mintTo(
            connection,
            { publicKey: walletPublicKey, signTransaction },
            mint,
            tokenAccount.address,
            walletPublicKey,
            totalUnits
          );

          statusEl.innerText = "BonusCoin minted successfully!";
          mintAddressEl.innerText = "Mint Address: " + mint.toBase58();
        } catch (err) {
          console.error(err);
          statusEl.innerText = "Error: " + (err.message || err.toString());
        }
      };
    });
  </script>
</body>
</html>
