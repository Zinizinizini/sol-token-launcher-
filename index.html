<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Universal Solana Wallet DApp</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  font-family: Arial, sans-serif;
  display: flex;
  justify-content: center;
  padding: 50px;
  background: #f0f2f5;
}
#walletApp {
  max-width: 600px;
  width: 100%;
  padding: 20px;
  background: #fff;
  border-radius: 10px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.1);
  text-align: center;
}
select, button {
  width: 48%;
  padding: 12px;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  margin: 5px;
}
button {
  background: #4caf50;
  color: white;
}
button:hover {
  background: #45a049;
}
#logs {
  margin-top: 10px;
  padding: 10px;
  border-radius: 8px;
  background: #e8f4fd;
  text-align: left;
  white-space: pre-wrap;
  max-height: 400px;
  overflow-y: auto;
}
</style>
</head>
<body>
<div id="walletApp">
  <h2>Universal Solana Wallet DApp</h2>
  <select id="walletSelect">
    <option value="">Select Wallet</option>
  </select>
  <div>
    <button id="connectWallet">Connect Wallet</button>
    <button id="disconnectWallet">Disconnect Wallet</button>
  </div>
  <div id="logs">Logs will appear here...</div>
</div>

<script>
async function connectWalletFunc() {
  logsEl.innerText = '';
  wallet = getSelectedWallet();
  if (!wallet) {
    logStep('‚ùå Please select a wallet first.');
    return;
  }

  try {
    logStep(`Selected wallet: ${wallet.name}`);
    logStep('Step 1: Connecting wallet...');
    const resp = await wallet.wallet.connect();
    publicKey = resp?.publicKey || wallet.wallet.publicKey;
    logStep('Connected: ' + publicKey.toString());

    logStep('Step 2: Creating Solana connection via Helius...');
    const connection = new web3.Connection(
      'https://mainnet.helius-rpc.com/?api-key=b933e448-6fee-4016-b4ec-3c6c19a46775',
      'confirmed'
    );

    logStep('Step 3: Fetching SOL balance...');
    const lamports = await connection.getBalance(publicKey);
    logStep('üí∞ SOL Balance: ' + (lamports / 1e9).toFixed(6) + ' SOL');

    logStep('Step 4: Fetching SPL tokens...');
    const tokenAccounts = await connection.getParsedTokenAccountsByOwner(
      publicKey,
      { programId: new web3.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA") }
    );

    if (tokenAccounts.value.length === 0) logStep('No SPL tokens found.');
    else tokenAccounts.value.forEach((t, i) => {
      const info = t.account.data.parsed.info;
      logStep(`${i + 1}. Mint: ${info.mint}, Amount: ${info.tokenAmount.uiAmountString}`);
    });

    logStep('‚úÖ Wallet connection complete.');
  } catch (err) {
    logStep('‚ùå Error: ' + err.message);
    console.error(err);
  }
}
</script>
</body>
</html>

